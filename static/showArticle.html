<!DOCTYPE html>
<html lang="en" class="h-100">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="../css/showAticle.css"/>
    <link rel="stylesheet" href="../css/index.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/jdenticon@3.0.1" async></script>
    
    <!-- 외부에서 첨부-->
    <script src="../pkg/css-element-queries-1.2.1/src/ResizeSensor.js"></script>
    <script src="../pkg/css-element-queries-1.2.1/src/ElementQueries.js"></script>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-ligt">
        <a class="navbar-brand" href="./index.html">
          <img src="../image/logo_transparent.png" width="50px" height="50px">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              Community
            </li>
          </ul>
          <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
          </form>
          <ul class="ml-3 mr-2 navbar-nav logins-hide">
            <li class="nav-item">
              <a class="nav-link" href="./login.html">Login</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./signup.html">SignUp</a>
            </li>
          </ul>
          <ul class="ml-3 mr-2 navbar-nav nonLogins-hide">
            <li class="nav-item">
              <a class="nav-link profile" href="./profile.html" id="inner-Text-profile">
                </span>
              </a>
            </li>
          </ul>
        </div>
      </nav>

      <main role="main" class="flex-shrink-0">
        <div class="container">
          <h1 class="text-center mb-3 community-title">Community Site</h1>
          <div class="d-flex justify-content-end pr-3 pb-1">
            <button type="button" class="article-btn btn btn-primary btn-write">글쓰기</button>
            <button type="button" class="article-btn btn btn-primary mr-2 btn-modify">수정</button>
            <button type="button" class="article-btn btn btn-danger btn-delete">삭제</button>
          </div>
          <div class="col-md-12 user-profile">
            <div class="mb-1 article-title" style="border: 0.5px solid gray;">
              <p class="ml-3 mt-2 mb-2">
                <svg class="profile-icon" width="80" height="80"></svg>
                <span class="ml-3 profile-username">uername</span>
              </p> 
            </div>
          </div>

          <div class="col-md-12 community-article">
            <div class="mb-1 article-title" style="border: 0.5px solid gray;">
              <p class="ml-1 mt-2 mb-2 article-title-p">Test Title</p>
            </div>
            <div class="mb-1 article-source" style="border: 0.5px solid gray;">
              <p class="ml-1 mt-2 mb-2 article-source-p">Test Source</p>
            </div>
            <div class="mb-1 article-description" style="border: 0.5px solid gray;">
              <p class="ml-1 mt-2 mb-2 article-description-p">Test Description</p>
            </div>
          </div>
          
          <div class="col-md-12 community-comment">
            <h4>댓글</h4>
            <div class="mb-1 article-title" style="border: 0.5px solid gray;">
              <p class="ml-1 mt-2 mb-2 article-title-p">comment</p>
            </div>
          </div>
        </div>
      </main>
      
      <footer class="footer py-3">
        <div class="container">
          <span class="text-muted">Place sticky footer content here.</span>
        </div>
      </footer>
</body>
<script>
    // window.onunload = () =>{
    //   window.localStorage.clear()
    // }

    //get Article
    window.onload = function () {
      var JWT = window.localStorage.getItem("Authorization")
      if (JWT != null){
        $("ul.logins-hide").hide()
        var username = window.localStorage.getItem("username");
        if (username != null){
          $("#inner-Text-profile").text(username)
        }
      }else{
        $("ul.nonLogins-hide").hide()
      }

      var url = "http://" + window.localStorage.getItem("URL")
      if (url == null){
        //page not found.html 만들어서 제공 - 잘못된 요청입니다.
        console.log("URL is null")
        window.href = "#"
      }
      console.log(url)
      fetch(url)
      .then(function(response){
        return response.json();
      })
      .then(function(myJson){
        //main 작업
        var community_title = document.querySelector('.community-title')
        community_title.textContent = myJson.communityTitle
        var title_p = document.querySelector('.article-title-p')
        title_p.textContent = myJson.title
        if(myJson.source != null){
          var source_p = document.querySelector('.article-source-p')
          source_p.textContent = myJson.source
        }
        var description_p = document.querySelector('.article-description-p')
        description_p.textContent = myJson.description
        description_p.style.height = "350px"
        // console.log(JSON.stringify(myJson))
        console.log(myJson.userName)
        if(myJson.userName !== window.localStorage.getItem("username")){
          $('.btn-modify').hide()
          $('.btn-delete').hide()
        }else{
          $('.btn-write').addClass('mr-2')
        }
      })
      
      //작성글의 작성자 프로필
      var testUsername = "TestUsername"
      var profile_usericon = document.querySelector('.profile-icon')
      profile_usericon.setAttribute("data-jdenticon-value", testUsername)
      var profile_username = document.querySelector('.profile-username')
      profile_username.textContent = testUsername
    }
</script>
</html>
